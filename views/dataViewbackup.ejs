<!DOCTYPE html>
<html>
  <head>
    <% include partials/bshead.ejs %>
    <script type="text/javascript">
      $(document).ready(function() {
        $('#Joblist').DataTable();
      } );
    </script>
    <script>
      function toggleVis(obj)
      {
        if(obj.style.display=='none')
        {
            obj.style.display = 'inline'
          }
        else
        {
          obj.style.display = 'none'
        }
      }
    </script>
  </head>
  <body>
    <% include partials/nav.ejs %>
    <h1 id="bigheader">DataView</h1>

    <table id="Joblist" class="table table-striped table-bordered" style="width:100%">
            <thead>
                <tr>
                    <th>AE Ticket</th>
                    <th>Status</th>
                    <th>Kun I</th>
                    <th>Age</th>
                    <th>Operator</th>
                    <th>Start/Stop</th>
                </tr>
            </thead>
            <tbody id="level3">
                <% data.forEach(function(item){ if((item.WorkflowName!= null && item.WorkflowName.indexOf('nexus')<0) || item.WorkflowName == null){  %>
                <tr id="level2">
                    <td>
                      <% if(item.WorkflowName!=null){ %>
                      <%= item.WorkflowName.replace(/swft/, '').replace(/Default/, '').replace(/wfnexus/, 'Nexus').replace(/\//g,'') %><% } %>
                    </td>
                    <td><%= item.Job_Status %></td>
                    <td id="level1">
                      <% if(item.WorkflowName!=null){ %>
                        <button class="badge badge-info badge-pill" style="outline: none;" onClick="document.getElementById('bigheader').innerHTML = this.parentNode.parentNode.parentNode.getElementsByTagName('tr')[1].id">i</button>
                      <% } %>
                    </td>
                    <td>61</td>
                    <td><%= item.Job_Operator %></td>
                    <td>
                      <small class="text-muted">
                        <% if(item.Job_StartTime!=null){ %>
                        <b>Start:</b>
                        <%= item.Job_StartTime.toISOString().replace(/T/, ' ').replace(/\..+/, '') %>
                        <% } %>
                      </small>
                      <br/>
                      <small class="text-muted">
                        <% if(item.Job_EndTime!=null){ %>
                        <b>End:</b>
                        <%= item.Job_EndTime.toISOString().replace(/T/, ' ').replace(/\..+/, '') %>
                        <% } %>
                      </small>
                    </td>
                </tr>
                <tr id="subinfo" style="display: none;">
                  <td>
                    <div id="level2B">
                      <h6 class="mb-1"><%= item.AE_JobID %></h6>
                    </div>
                  </td>
                </tr>
                  <%} }); %>
                </tbody>
        </table>

  </body>
</html>
